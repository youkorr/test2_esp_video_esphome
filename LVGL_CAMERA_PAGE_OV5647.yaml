# Page LVGL simplifi√©e pour cam√©ra OV5647
# R√©solutions disponibles: 640x480 (VGA) ou 1024x600
# Contr√¥les: BACK, START, STOP, INFO

# ============================================
# VERSION 1: VGA 640x480
# ============================================
lvgl:
  pages:
    - id: camera_page_vga
      bg_color: 0x000000  # Fond noir

      widgets:
        # Canvas cam√©ra - VGA centr√© sur √©cran 800x480
        - canvas:
            id: camera_canvas
            width: 640
            height: 480
            x: 80   # Centr√©: (800-640)/2 = 80
            y: 0
            bg_color: 0x000000

        # Bouton RETOUR
        - button:
            id: btn_camera_back
            width: 70
            height: 45
            x: 5
            y: 10
            bg_color: 0x333333
            radius: 8
            on_click:
              then:
                - lambda: |-
                    ESP_LOGI("camera", "üîô Arr√™t et retour");
                    id(tab5_cam).stop_streaming();
                - lvgl.page.show: page_home
            widgets:
              - label:
                  text: "BACK"
                  text_color: 0xFFFFFF
                  text_font: nunito_18
                  text_align: CENTER

        # Bouton START
        - button:
            id: btn_start
            width: 70
            height: 45
            x: 5
            y: 65
            bg_color: 0x00AA00
            radius: 8
            on_click:
              then:
                - lambda: |-
                    ESP_LOGI("camera", "‚ñ∂Ô∏è  START OV5647");
                    if (id(tab5_cam).start_streaming()) {
                      lv_label_set_text(id(status_label), "VGA");
                    }
            widgets:
              - label:
                  text: "START"
                  text_color: 0xFFFFFF
                  text_font: nunito_18
                  text_align: CENTER

        # Bouton STOP
        - button:
            id: btn_stop
            width: 70
            height: 45
            x: 5
            y: 120
            bg_color: 0xCC0000
            radius: 8
            on_click:
              then:
                - lambda: |-
                    id(tab5_cam).stop_streaming();
                    lv_label_set_text(id(status_label), "STOP");
            widgets:
              - label:
                  text: "STOP"
                  text_color: 0xFFFFFF
                  text_font: nunito_18
                  text_align: CENTER

        # Bouton INFO
        - button:
            id: btn_info
            width: 70
            height: 45
            x: 5
            y: 175
            bg_color: 0x4682B4
            radius: 8
            on_click:
              then:
                - lambda: |-
                    ESP_LOGI("camera", "üìä OV5647 VGA");
                    ESP_LOGI("camera", "R√©solution: 640x480");
                    ESP_LOGI("camera", "Bayer: GBRG");
                    ESP_LOGI("camera", "Binning: 4x4");
            widgets:
              - label:
                  text: "INFO"
                  text_color: 0xFFFFFF
                  text_font: nunito_18
                  text_align: CENTER

        # Status
        - label:
            id: status_label
            text: "READY"
            x: 40
            y: 450
            text_color: 0xFF8800
            text_font: nunito_20

# ============================================
# VERSION 2: 1024x600 (pour √©cran 7")
# ============================================
# lvgl:
#   pages:
#     - id: camera_page_1024x600
#       bg_color: 0x000000
#
#       widgets:
#         # Canvas plein √©cran pour √©cran 1024x600
#         - canvas:
#             id: camera_canvas
#             width: 1024
#             height: 600
#             x: 0
#             y: 0
#             bg_color: 0x000000
#
#         # Boutons en overlay en haut √† droite
#         - button:
#             id: btn_back
#             width: 90
#             height: 45
#             x: 920
#             y: 10
#             bg_color: 0x333333
#             bg_opa: 200  # Semi-transparent
#             radius: 8
#             on_click:
#               then:
#                 - lambda: |-
#                     id(tab5_cam).stop_streaming();
#                 - lvgl.page.show: page_home
#             widgets:
#               - label:
#                   text: "BACK"
#                   text_color: 0xFFFFFF
#                   text_font: nunito_20
#
#         - button:
#             id: btn_start
#             width: 90
#             height: 45
#             x: 920
#             y: 65
#             bg_color: 0x00AA00
#             bg_opa: 200
#             radius: 8
#             on_click:
#               then:
#                 - lambda: |-
#                     id(tab5_cam).start_streaming();
#             widgets:
#               - label:
#                   text: "START"
#                   text_color: 0xFFFFFF
#                   text_font: nunito_20
#
#         # ... (STOP et INFO similaires)

# ============================================
# CONFIGURATION CAM√âRA OV5647
# ============================================
# mipi_dsi_cam:
#   id: tab5_cam
#   i2c_id: bsp_bus
#   sensor_type: ov5647
#   xclk_pin: GPIO36
#   xclk_freq: 24000000
#   sensor_addr: 0x36           # OV5647 = 0x36
#   resolution: "VGA"           # ou "1024x600"
#   pixel_format: RGB565
#   framerate: 30
